<script init>
    document.title = 'metw'
    if (session.logged) {
        p.posts = metw.gui.posts([])
        p.posts.data = await session.homepage()
        p.posts.cursor = p.posts.data[30]?.id
        p.posts.append(p.posts.data)
    }
</script>

<template>
    <div class="default">
        <h1><b>metw</b>.cc</h1> - minimalist sosyal medya
        <br />
        <br />
        <a class="href" onclick="app.redirect('giriş')">Giriş yapın</a>, <a class="href" onclick="app.redirect('katıl')">kaydolun</a> veya <a class="href" onclick="app.redirect('keşfet')">keşfedin</a>
    </div>
</template>

<style>
    .p { padding: 2em 1em!important }
    .p h1 { display: inline-block; margin: 0; font-size: 1.75em; font-weight: normal }
    .p ul { margin: 0; padding-top: 1em; padding-bottom: 0 }
    .p > button { display: block; width: min(75%, 500px); margin: 1em auto }
    .p .quiet { text-align: center }
    .p h2 { margin: 0; font-weight: normal; font-size: 1.5em; text-align: center }
</style>

<script>
    if (session.logged) {
        p.querySelector('.default').remove()
        if (p.posts.data.length) {
            p.innerHTML += '<h2>Ana sayfa</h2>'
            p.appendChild(p.posts)
            var loadMore = d.createElement('button')
            loadMore.innerHTML = 'devamını yükle', loadMore.className = '_load-more'
            if (!(p.posts.data.length % 30)) p.appendChild(loadMore)
            loadMore.onclick = async () => {
                p.posts.data = await load(async () => await session.homepage(p.posts.data.at(-1)?.id))
                if (!p.posts.cursor) loadMore.remove()
                p.posts.append(p.posts.data)
            }
        } else {
            p.innerHTML += `
                <div class="quiet">
                    Burası sizin ana sayfanız. Takip ettiklerinizin gönderileri burada gözükür.<br>
                    Ancak bir sessizlik... Takip edecek <b class="href" onclick="app.redirect('/keşfet')">birisini bulmaya ne dersiniz?</b>
                </div>`
        }
    }
</script>